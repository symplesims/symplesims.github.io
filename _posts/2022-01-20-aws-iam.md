---
layout: post
title: "AWS 클라우드의 시작 IAM 서비스"
date:  2022-01-20 15:00:00 +0900
categories: 
  - DevOps
  - IAM
---

`무료 AWS 계정에 가입 - 지금 바로 AWS 에서 구축` 시작 이라는 안내 문구를 본적이 있을 까요?   

여기 [AWS 프리티어](https://aws.amazon.com/ko/free) 링크를 통해 우리는 AWS 클라우드 여정을 빠르게 시작할 수 있습니다.  
그리고 최초 가입과 함께 모든 권한을 사용 할 수 있는 `ROOT 어카운트`를 발급 받습니다.  

ROOT 어카운트는 놀랍게도 대한 민국이 운영 하고 있는 [Data Center](https://ko.wikipedia.org/wiki/%EB%8D%B0%EC%9D%B4%ED%84%B0_%EC%84%BC%ED%84%B0) 를 AWS 가 커버하고 있는 전세계를 대상으로 한개도 아니고, 
무려 사용자가 만들고 싶은 만큼 [클라우드](https://ko.wikipedia.org/wiki/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85?tableofcontents=1) 환경에서 생성 할 수 있습니다.  
셀 수 없을 만큼의 Infrastructure, Platform, Software, Function 유형의 자원들을 서비스로 올릴 수 있으며 우리는 사용한 만큼만 요금을 지불 하면 됩니다.  

<br>

<div align="center">
<img src="https://symplesims.github.io/assets/images/220120/cloud-network.png" />
[클라우드 가상화 세상]
</div>

근데 만약, 본인이 발급 받은 ROOT 어카운트를 누군가에게 해킹 되었다면 어떻게 될지 생각해 보세요.  
해커는 막강한 ROOT 어카운트를 통해 전세계를 대상으로 원하는 만큼의 모든 가능한 리소스를 클라우드에 만들어 사용할 수 있습니다.  
실제로 액세스 키가 유출되어 해커가 컴퓨팅인스턴스를 대량으로 만들어 코인 체굴이나 ML 학습을 하는 해킹 피해 사례는 간간히 일어 납니다.  

## Root 어카운트 보호
Root 계정이 해커에 의해 탈취되지 않도록 가장 선행적으로 다음과 같은 보호 설정을 합니다.  
1. 루트 사용자 MFA 설정 
2. 루트 사용자 Access Key 삭제
3. 관리를 위한 별도의 사용자 계정 추가

### 사용자 MFA 설정
AWS Cloud 를 로그인 하는 모든 계정에 대해 MFA 를 활성화 함으로써 좀 더 안전한 계정 보호를 하도록 합니다. Root 계정과 콘솔 로그인을 하는 계정 모두는 필수적으로 설정하는것이 좋습니다. 

IAM 서비스의 대시보드 메뉴에서 '보안 상태' 항목에서 MFA 활성화를 할 수 있습니다. 

- MFA 관리

![](/assets/images/220120/iam-01.png)

<br>

- 보안 자격 증명 - MFA 활성화

![](/assets/images/220120/iam-02.png)


- 가상 MFA 디바이스 설정  

![](/assets/images/220120/iam-03.png)

<br>


- 가상 MFA 활성화 처리

![](/assets/images/220120/iam-04.png)

<br>

QR-Code 는 MFA 가상 디바이스를 등록 하는 코드 입니다.  
MFA 앱으로 실행 하고 해당 QR-Code 를 스캔하면 가상 디바이스를 등록 할 수 있는 6자리 숫자 토큰이 생성 됩니다.   
처음 나온 6자리 숫자를 `MFA 코드 1` 항목에 입력하고, 그 다음에 나우는 6자리 숫자를 `MFA 코드 2` 에 입력 하면 MFA 가상 디바이스가 활성화 됩니다.

<br>

### 루트 사용자 Access Key 삭제

IAM 서비스의 대시보드 메뉴에서 '보안 자격 증명' 항목에서 액세스 키 관리를 할 수 있습니다.  
여기에서 액세스 키 생성을 하지 않도록 유의하여 주세요, 혹시라도 생성된 키가 있다면 사용중인 리소스가 없도록 조치 하고 안전하게 삭제해야 합니다.  

![](/assets/images/220120/iam-05.png)

<br>

### 관리를 위한 별도의 사용자 계정 추가

클라우드 운영 관리를 위해 별도의 사용자 계정을 추가 합니다. 역할 중심의 제한된 권한 (Policy) 을 설정 하고, 역할 셋(Role) 을 통해 그룹화하여 사용자 및 리소스에게 해당 역할을 달당 함으로써 보다 안전하게 클라우드를 액세스 할 수 있습니다. 

사용자 계정 추가는 5 단계를 거쳐 생성이 됩니다. 

1. 사용자 아이디 입력   
![](/assets/images/220120/iam-12.png)

여기에서 사용자 아이디 및 액세스 유형을 선택 할 수 있습니다.  

<br>

2. 사용자 권한 설정  

사용자 권한은 3가지 유형으로 설정 할 수 있습니다. 
<br>

- 사용자 그룹을 생성하고 권한셋을 설정한 다음 사용자를 해당 그룹에 추가 하는 방식   

![](/assets/images/220120/iam-13a.png)
<br>

- 기존 사용자의 권한을 생성될 사용자에게 복사 하는 방식  

![](/assets/images/220120/iam-13b.png)
<br>
 
- 필요한 권한을 선택하여 사용자에게 직접 추가하는 방식  

![](/assets/images/220120/iam-13c.png)

<br>


3. 태깅 속성 추가

사용자 계정 관리를 모니터링하고 자동화 하기 위해 필요한 태그 속성을 추가 할 수 있습니다.  
 
![](/assets/images/220120/iam-14.png)

<br>

4. 사용자 만들기  

입력한 정보를 기반으로 우측 하단의 사용자 만들기 버튼을 클릭하여 사용자를 생성 할 수 있습니다. 

![](/assets/images/220120/iam-15.png)

<br>

5. 사용자 추가  

사용자가 생성 되면 정보 안내와 함께 로그인 링크와, 자동으로 생성된 AccessKey 를 확인 할 수 있습니다.  

![](/assets/images/220120/iam-16.png)

위와 같이 관리 콘솔에 로그인 하는 사용자를 생성한 경우 라면, 뱔급된 AccessKey 를 사용하지 않고 삭제 하는 것이 좋습니다.  
AccessKey 의 사용은 별도의 프로그래밍 방식의 사용자 계정을 생성 하여 사용하는 것을 권고합니다. 

<br><br>


## IAM

누가?
무엇을? 
어떻게 할수 있는가?

다른계정과 리소스 공유
- Identity Federation (페이스 북, 구글 등 로그인 연동)

### 사용자
AWS 를 사용하는 사람 또는 애플리케이션 입니다.

## 그룹
사용자의 집합으로 사용자를 추가 하고, 권한 셋을 설정 할 수 있습니다.

## 정책
액세스 권한 장책을 설정 합니다.

## 역할
- 사용자가 역할을 부여 받고 그 역할로써 사용합니다.
- AWS 리소스  
